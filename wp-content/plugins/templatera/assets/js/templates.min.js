!function(n,i,o){"use strict";window.vc_reloadTemplateList=function(e){n.ajax({type:"POST",url:window.ajaxurl,data:e}).done(function(e){n("[data-vc-template=list]").html(e)})},n(document).ready(function(){window.vc&&window.vc.storage&&(n("[data-vc-template=list]").on("click","[data-templatera_id]",function(e){e.preventDefault(),n.ajax({type:"POST",url:window.ajaxurl,data:{action:"templatera_plugin_load",template_id:n(this).data("templatera_id"),_vcnonce:window.vcAdminNonce},dataType:"html"}).done(function(t){if(o.isEmpty(t))return!1;o.each(i.filters.templates,function(e){t=e(t)}),i.storage.append(n.trim(t)),i.shortcodes.fetch({reset:!0})})}),n("#templatera_save_button").on("click",function(e){var t,a;e.preventDefault(),t=window.prompt(window.VcTemplateI18nLocale.please_enter_templates_name,""),o.isString(t)&&t.length&&(a={action:"templatera_plugin_save",content:i.storage.getContent(),title:t,post_id:n("#post_ID").val(),_vcnonce:window.vcAdminNonce},window.vc_reloadTemplateList(a))}))}),window.vc&&window.vc.shortcode_view&&i&&i.shortcode_view&&(window.VcTemplateraModel=window.Backbone.Model.extend({getParam:function(e){return window._.isObject(this.get("params"))&&!window._.isUndefined(this.get("params")[e])?this.get("params")[e]:""}}),window.VcTemplatera=i.shortcode_view.extend({render:function(){return window.VcTemplatera.__super__.render.call(this),this.$wrapper=this.$el.find("> .wpb_element_wrapper"),n('<div class="vct_cover"/>').insertBefore(this.$wrapper),this},changeShortcodeParams:function(e){var t=e.get("params");window.VcTemplatera.__super__.changeShortcodeParams.call(this,e),window._.isObject(t)&&window._.isString(t.id)?(this.$wrapper.html('<img src="images/wpspin_light.gif" title="Loading..." class="templatera_loader">'),n.ajax({type:"post",url:window.ajaxurl,data:{action:"wpb_templatera_load_html",id:t.id,_vcnonce:window.vcAdminNonce},context:this}).done(function(e){this.$wrapper.html("");var t=i.storage.parseContent({},e);window._.each(t,function(e){var t=new window.VcTemplateraModel(e);this.appendShortcode(t)},this)})):this.$wrapper.html("")},appendShortcode:function(e){var t=this.getView(e),a=!1!==e.get("parent_id")?i.app.views[e.get("parent_id")].$content:this.$wrapper;i.app.views[e.id]=t,e.get("parent_id")&&i.app.views[e.get("parent_id")].unsetEmpty();a.append(t.render().el),t.ready(),t.changeShortcodeParams(e),t.checkIsEmpty()},getView:function(e){return o.isObject(i.map[e.get("shortcode")])&&o.isString(i.map[e.get("shortcode")].js_view)&&i.map[e.get("shortcode")].js_view.length?new(window[window.vc.map[e.get("shortcode")].js_view])({model:e}):new i.shortcode_view({model:e})},changedContent:function(){this.$wrapper.find(".templatera_loader").remove()}}))}(window.jQuery,window.vc,window._);